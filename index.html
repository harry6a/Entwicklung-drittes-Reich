<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Horizontale Zeitleiste – gestaffelte Labels (1914–1945)</title>
<style>
  :root{
    --bg:#ffffff; --fg:#0f172a; --muted:#5f6368; --line:#c7cacf; --accent:#1a73e8;
    --card:#f7f9fc; --shadow:0 10px 24px rgba(0,0,0,.10);
    --lane-gap: 90px; /* vertikaler Abstand zwischen den Lanes */
  }
  html,body{margin:0;padding:0;background:var(--bg);color:var(--fg);
    font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Helvetica,Arial,sans-serif;
    font-size:16px;line-height:1.45}
  .wrap{max-width:1100px;margin:26px auto;padding:0 16px}
  h1{font-size:clamp(1.25rem,2.4vw,1.7rem);margin:0 0 6px}
  .lead{color:var(--muted);margin:0 0 12px}
  .tools{display:flex;gap:10px;align-items:center;margin:8px 0 10px}
  .btn{border:1px solid #d2d6dc;background:#fff;border-radius:10px;padding:8px 12px;font-weight:700;cursor:pointer}
  .btn:hover{background:#f6f8fb}
  .hint{color:#6b7280; font-size:.9rem}

  section{margin:18px 0 30px}
  .section-head{display:flex;justify-content:space-between;align-items:baseline;gap:12px;margin-bottom:8px}
  .section-head h2{font-size:clamp(1.05rem,2vw,1.28rem);margin:0}
  .range{color:var(--muted);font-weight:600}

  /* Scroll-Container */
  .scroller{position:relative; overflow-x:auto; overflow-y:visible;
    border:1px solid #e6e9ee; border-radius:14px; background:#fff; box-shadow:var(--shadow)}
  .scroller:focus{outline:2px solid var(--accent)}

  /* Track: mittlere Zeitlinie */
  .track{
    position:relative; height:540px; min-width:100%;
    background:linear-gradient(to right, var(--line) 0 100%);
    background-repeat:no-repeat; background-size:100% 2px; background-position:0 50%;
  }

  /* Jahres-Ticks */
  .tick{position:absolute; top:calc(50% - 6px); width:1px; height:12px; background:#b7bdc6;}
  .tick .tlabel{position:absolute; top:14px; left:-18px; width:36px; text-align:center; font-size:.82rem; color:#8a919a;}

  /* Ereignis-Container (nur die Box; Stiel/Punkt hängen wir am Track an) */
  details.event{ position:absolute; width:290px; }
  details.event summary{ list-style:none; outline:none; cursor:pointer; }
  details.event summary::-webkit-details-marker{display:none}

  /* Stiel + Punkt (werden dynamisch erzeugt) */
  .stem{ position:absolute; width:2px; background:#9db2ff; }
  .dot{ position:absolute; width:12px; height:12px; border-radius:50%; background:var(--accent);
        box-shadow:0 0 0 6px #1a73e81a; }

  /* Label-Karte */
  .label{
    display:inline-block; max-width:270px;
    background:#fff; border:1px solid #e7ebf0; border-radius:10px; padding:8px 10px;
    box-shadow:var(--shadow);
  }
  .title{font-weight:800}
  .date{color:#6b7280; font-weight:600; font-variant-numeric:tabular-nums; white-space:nowrap}

  /* Zusatzinhalt */
  .content{ margin-top:8px; background:var(--card); border:1px solid #e7ebf0; border-radius:12px; padding:10px 12px; box-shadow:var(--shadow) }
  .content p{margin:.2rem 0}
  .content ul{margin:.4rem 0 0 18px}
  .content li{margin:.2rem 0}

  /* Lanes: vertikale Staffelung ober/unter der Linie */
  .top    { transform: translateY(calc(-1 * var(--lane) * var(--lane-gap))); }
  .bottom { transform: translateY(calc(+1 * var(--lane) * var(--lane-gap))); }

  @media (max-width:700px){
    .track{height:600px}
    details.event{width:260px}
    .label{max-width:240px}
  }
  @media print{
    .wrap{max-width:100%;margin:0;padding:0 10mm}
    .scroller{overflow:visible; border:0; box-shadow:none}
    .track{height:auto}
    details.event{position:static; width:auto}
  }
</style>
</head>
<body>
<div class="wrap">
  <h1>Zeitleiste (gestaffelte Labels): Weimarer Republik, NS-Herrschaft & Zweiter Weltkrieg</h1>
  <p class="lead">Labels wechseln <b>oberhalb</b>/<b>unterhalb</b> der Mittellinie und sind per Stiel präzise ans Datum gekoppelt. Pro Abschnitt eigener Maßstab via <code>data-ppyear</code>.</p>
  <div class="tools">
    <button class="btn" id="openAll">Alle öffnen</button>
    <button class="btn" id="closeAll">Alle schließen</button>
    <span class="hint">Tipp: Shift+Mausrad / Pfeiltasten scrollen horizontal.</span>
  </div>

  <!-- Abschnitt 1 -->
  <section>
    <div class="section-head">
      <h2>1) Erster Weltkrieg → Machtübernahme</h2>
      <span class="range">Start: 28.07.1914 · Ende: 30.01.1933</span>
    </div>
    <div class="scroller" tabindex="0">
      <div class="track"
           data-start="1914-07-28"
           data-end="1933-01-30"
           data-ppyear="320"
           data-ticks="1915,1920,1925,1930">
        <details class="event" data-date="1918-11-10" data-side="top">
          <summary class="label"><span class="date">09.–11.11.1918</span> — <span class="title">Novemberrevolution & Abdankung</span></summary>
          <div class="content"><p>Ende der Monarchie; 11.11. Waffenstillstand.</p></div>
        </details>
        <details class="event" data-date="1919-06-28" data-side="bottom">
          <summary class="label"><span class="date">28.06.1919</span> — <span class="title">Versailler Vertrag</span></summary>
          <div class="content"><p>Gebietsverluste, Reparationen, „Kriegsschuldartikel“.</p></div>
        </details>
        <details class="event" data-date="1923-11-09" data-side="top">
          <summary class="label"><span class="date">08./09.11.1923</span> — <span class="title">Hitler-Ludendorff-Putsch</span></summary>
          <div class="content"><p>NSDAP verboten; Hitler in Haft (1924).</p></div>
        </details>
        <details class="event" data-date="1926-09-08" data-side="bottom">
          <summary class="label"><span class="date">1924–1929</span> — <span class="title">Stabilisierungsjahre</span></summary>
          <div class="content"><p>Dawes/Young-Plan; Völkerbund 1926; Erholung.</p></div>
        </details>
        <details class="event" data-date="1929-10-24" data-side="top">
          <summary class="label"><span class="date">ab 10/1929</span> — <span class="title">Weltwirtschaftskrise</span></summary>
          <div class="content"><p>Massenarbeitslosigkeit → Radikalisierung.</p></div>
        </details>
        <details class="event" data-date="1931-06-01" data-side="bottom">
          <summary class="label"><span class="date">1930–1932</span> — <span class="title">Präsidialkabinette</span></summary>
          <div class="content"><p>Regieren per Notverordnung; Aushöhlung des Parlaments.</p></div>
        </details>
        <details class="event" data-date="1932-07-31" data-side="top">
          <summary class="label"><span class="date">07 & 11/1932</span> — <span class="title">Reichstagswahlen</span></summary>
          <div class="content"><p>NSDAP stärkste Partei ohne absolute Mehrheit.</p></div>
        </details>
        <details class="event" data-date="1933-01-30" data-side="bottom">
          <summary class="label"><span class="date">30.01.1933</span> — <span class="title">Hitler wird Reichskanzler</span></summary>
          <div class="content"><p>Koalition/Duldung Konservativer; Beginn der Diktaturbildung.</p></div>
        </details>
      </div>
    </div>
  </section>

  <!-- Abschnitt 2 -->
  <section>
    <div class="section-head">
      <h2>2) Machtübernahme → Kriegsbeginn</h2>
      <span class="range">Start: 30.01.1933 · Ende: 31.08.1939</span>
    </div>
    <div class="scroller" tabindex="0">
      <div class="track"
           data-start="1933-01-30"
           data-end="1939-08-31"
           data-ppyear="350"
           data-ticks="1933,1935,1937,1939">
        <details class="event" data-date="1933-02-28" data-side="top">
          <summary class="label"><span class="date">27./28.02.1933</span> — <span class="title">Reichstagsbrand & Verordnung</span></summary>
          <div class="content"><p>Aussetzung zentraler Grundrechte; Verhaftungen.</p></div>
        </details>
        <details class="event" data-date="1933-03-23" data-side="bottom">
          <summary class="label"><span class="date">23.03.1933</span> — <span class="title">Ermächtigungsgesetz</span></summary>
          <div class="content"><p>Gesetzgebung ohne Parlament – Basis der Diktatur.</p></div>
        </details>
        <details class="event" data-date="1933-06-30" data-side="top">
          <summary class="label"><span class="date">03–07/1933</span> — <span class="title">Gleichschaltung</span></summary>
          <div class="content"><p>Länder/Parteien/Verbände unter NS-Kontrolle.</p></div>
        </details>
        <details class="event" data-date="1933-03-22" data-side="bottom">
          <summary class="label"><span class="date">22.03.1933</span> — <span class="title">KZ Dachau</span></summary>
          <div class="content"><p>Frühlager; Ausbau des KZ-Systems.</p></div>
        </details>
        <details class="event" data-date="1933-04-01" data-side="top">
          <summary class="label"><span class="date">01.04.1933</span> — <span class="title">Boykott jüdischer Geschäfte</span></summary>
          <div class="content"><p>Beginn systematischer Ausgrenzung; 07.04. Berufsbeamtengesetz.</p></div>
        </details>
        <details class="event" data-date="1934-06-30" data-side="bottom">
          <summary class="label"><span class="date">30.06.–02.07.1934</span> — <span class="title">„Röhm-Putsch“</span></summary>
          <div class="content"><p>Ausschaltung SA-Spitze; Machtfestigung.</p></div>
        </details>
        <details class="event" data-date="1934-08-02" data-side="top">
          <summary class="label"><span class="date">02.08.1934</span> — <span class="title">Tod Hindenburgs</span></summary>
          <div class="content"><p>Hitler vereint Ämter; Führereid der Wehrmacht.</p></div>
        </details>
        <details class="event" data-date="1935-09-15" data-side="bottom">
          <summary class="label"><span class="date">15.09.1935</span> — <span class="title">Nürnberger Gesetze</span></summary>
          <div class="content"><p>Entzug von Bürgerrechten für Juden.</p></div>
        </details>
        <details class="event" data-date="1935-03-16" data-side="top">
          <summary class="label"><span class="date">16.03.1935</span> — <span class="title">Wehrpflicht & Aufrüstung</span></summary>
          <div class="content"><p>Bruch von Versailles; 03/1936 Rheinland.</p></div>
        </details>
        <details class="event" data-date="1936-10-01" data-side="bottom">
          <summary class="label"><span class="date">1936</span> — <span class="title">Vierjahresplan & Achse</span></summary>
          <div class="content"><p>Autarkie/Aufrüstung; Unterstützung Francos.</p></div>
        </details>
        <details class="event" data-date="1938-03-12" data-side="top">
          <summary class="label"><span class="date">12./13.03.1938</span> — <span class="title">„Anschluss“ Österreichs</span></summary>
          <div class="content"><p>Eingliederung ins Deutsche Reich.</p></div>
        </details>
        <details class="event" data-date="1938-09-30" data-side="bottom">
          <summary class="label"><span class="date">29./30.09.1938</span> — <span class="title">Münchner Abkommen</span></summary>
          <div class="content"><p>Sudetenland an Deutschland (Appeasement).</p></div>
        </details>
        <details class="event" data-date="1938-11-09" data-side="top">
          <summary class="label"><span class="date">09./10.11.1938</span> — <span class="title">Novemberpogrome</span></summary>
          <div class="content"><p>Synagogen/Geschäfte zerstört; Massenverhaftungen.</p></div>
        </details>
        <details class="event" data-date="1939-03-15" data-side="bottom">
          <summary class="label"><span class="date">15.03.1939</span> — <span class="title">Besetzung Rest-Tschechiens</span></summary>
          <div class="content"><p>Protektorat Böhmen & Mähren.</p></div>
        </details>
        <details class="event" data-date="1939-08-23" data-side="top">
          <summary class="label"><span class="date">23.08.1939</span> — <span class="title">Hitler-Stalin-Pakt</span></summary>
          <div class="content"><p>Nichtangriffspakt mit Geheimprotokoll.</p></div>
        </details>
      </div>
    </div>
  </section>

  <!-- Abschnitt 3 -->
  <section>
    <div class="section-head">
      <h2>3) Kriegsbeginn → Kapitulation</h2>
      <span class="range">Start: 01.09.1939 · Ende: 08.05.1945</span>
    </div>
    <div class="scroller" tabindex="0">
      <div class="track"
           data-start="1939-09-01"
           data-end="1945-05-08"
           data-ppyear="390"
           data-ticks="1940,1942,1944">
        <details class="event" data-date="1939-09-01" data-side="top">
          <summary class="label"><span class="date">01.09.1939</span> — <span class="title">Überfall auf Polen</span></summary>
          <div class="content"><p>Beginn des Zweiten Weltkriegs; 03.09. Kriegserklärungen GB & FR.</p></div>
        </details>
        <details class="event" data-date="1940-04-09" data-side="bottom">
          <summary class="label"><span class="date">04–06/1940</span> — <span class="title">Norden & Westfeldzug</span></summary>
          <div class="content">
            <ul>
              <li>09.04. Dänemark & Norwegen</li>
              <li>05–06/1940 Benelux & Frankreich; 22.06. Waffenstillstand</li>
              <li>07–10/1940 Luftschlacht um England (scheitert), ab 09/1940 „Blitz“</li>
            </ul>
          </div>
        </details>
        <details class="event" data-date="1941-04-06" data-side="top">
          <summary class="label"><span class="date">04/1941</span> — <span class="title">Balkanfeldzug</span></summary>
          <div class="content"><p>Jugoslawien & Griechenland.</p></div>
        </details>
        <details class="event" data-date="1941-06-22" data-side="bottom">
          <summary class="label"><span class="date">22.06.1941</span> — <span class="title">Unternehmen Barbarossa</span></summary>
          <div class="content"><p>Angriff auf die Sowjetunion; Vernichtungskrieg; Massaker der Einsatzgruppen.</p></div>
        </details>
        <details class="event" data-date="1941-12-07" data-side="top">
          <summary class="label"><span class="date">07–12/1941</span> — <span class="title">Krieg wird global</span></summary>
          <div class="content"><p>07.12. Pearl Harbor; 11.12. Kriegserklärung an USA.</p></div>
        </details>
        <details class="event" data-date="1942-01-20" data-side="bottom">
          <summary class="label"><span class="date">20.01.1942</span> — <span class="title">Wannsee-Konferenz</span></summary>
          <div class="content"><p>Koordination der „Endlösung“.</p></div>
        </details>
        <details class="event" data-date="1942-10-23" data-side="top">
          <summary class="label"><span class="date">10/1942–05/1943</span> — <span class="title">Afrika & Wende</span></summary>
          <div class="content"><p>El Alamein; Ende Afrikafeldzug; 07/1942–02/1943 Stalingrad.</p></div>
        </details>
        <details class="event" data-date="1943-08-01" data-side="bottom">
          <summary class="label"><span class="date">07–09/1943</span> — <span class="title">Kursk & Italien</span></summary>
          <div class="content"><p>Kursk; 08/09 Sturz Mussolinis; 08.09. italienischer Waffenstillstand.</p></div>
        </details>
        <details class="event" data-date="1944-06-06" data-side="top">
          <summary class="label"><span class="date">06.06.1944</span> — <span class="title">D-Day & Befreiung</span></summary>
          <div class="content"><p>Landungen in der Normandie; 08/1944 Befreiung von Paris.</p></div>
        </details>
        <details class="event" data-date="1944-07-20" data-side="bottom">
          <summary class="label"><span class="date">20.07.1944</span> — <span class="title">Attentat auf Hitler</span></summary>
          <div class="content"><p>Stauffenberg scheitert; Repressionswelle.</p></div>
        </details>
        <details class="event" data-date="1945-01-27" data-side="top">
          <summary class="label"><span class="date">27.01.1945</span> — <span class="title">Auschwitz befreit</span></summary>
          <div class="content"><p>Weitere Lager: Buchenwald 11.04., Dachau 29.04.</p></div>
        </details>
        <details class="event" data-date="1945-05-08" data-side="bottom">
          <summary class="label"><span class="date">04–05/1945</span> — <span class="title">Berlin & Kapitulation</span></summary>
          <div class="content"><p>16.04.–02.05. Schlacht um Berlin; 30.04. Hitlers Suizid; 07./08.05. Kapitulation.</p></div>
        </details>
      </div>
    </div>
  </section>
</div>

<script>
(function(){
  const DEFAULT_PX_PER_YEAR = 300;      // Fallback, falls data-ppyear fehlt
  const LANES_TOP = 4;
  const LANES_BOTTOM = 4;
  const PADDING = 16;                   // Randpuffer für Label-Box

  const toDate = (s) => {
    const p = (s||'').split('-').map(Number);
    if(p.length===1) return new Date(p[0],0,1);
    if(p.length===2) return new Date(p[0],p[1]-1,1);
    return new Date(p[0],(p[1]||1)-1,p[2]||1);
  };
  const years = (a,b) => (b-a)/(365.2425*24*3600*1000);

  document.querySelectorAll('.track').forEach(track => {
    const start = toDate(track.dataset.start);
    const end = toDate(track.dataset.end);
    const spanYears = Math.max(1, years(start,end));
    const ppy = parseFloat(track.dataset.ppyear || DEFAULT_PX_PER_YEAR);
    const width = Math.max(track.clientWidth, Math.round(spanYears * ppy));
    track.style.width = width + 'px';

    // Jahres-Ticks
    (track.dataset.ticks||'').split(',').map(s=>parseInt(s)).filter(Boolean).forEach(y=>{
      const d = new Date(y,0,1);
      const x = Math.max(0, Math.min(1,(d-start)/(end-start))) * width;
      const t = document.createElement('div'); t.className='tick'; t.style.left=(x|0)+'px';
      const lab = document.createElement('div'); lab.className='tlabel'; lab.textContent=y;
      t.appendChild(lab); track.appendChild(t);
    });

    // Lane-Reservierung (Rechtsrand je Lane)
    const laneRightTop = Array(LANES_TOP).fill(-1e9);
    const laneRightBottom = Array(LANES_BOTTOM).fill(-1e9);

    // Events nach Datum sortiert
    const evs = Array.from(track.querySelectorAll('details.event')).sort((a,b)=> toDate(a.dataset.date)-toDate(b.dataset.date));

    evs.forEach((ev,i)=>{
      const d = toDate(ev.dataset.date);
      const ratio = (d - start) / (end - start);
      const x = Math.max(0, Math.min(1, ratio)) * width; // echte Ereignisposition

      // Seite (oder alternierend)
      let side = (ev.dataset.side || (i%2 ? 'bottom' : 'top')).toLowerCase();
      if(side!=='top' && side!=='bottom') side='top';

      // Labelbreite schätzen/messen
      const label = ev.querySelector('.label');
      const tmp = label ? label.cloneNode(true) : null;
      let labelWidth = 260;
      if(tmp){
        tmp.style.visibility='hidden'; tmp.style.position='absolute'; tmp.style.left='-9999px';
        document.body.appendChild(tmp);
        labelWidth = tmp.offsetWidth || 260;
        document.body.removeChild(tmp);
      }

      // verfügbare Lane suchen
      const lanes = side==='top' ? laneRightTop : laneRightBottom;
      const maxLanes = side==='top' ? LANES_TOP : LANES_BOTTOM;
      let lane = 0;
      for(; lane<maxLanes; lane++){
        if(x - lanes[lane] > labelWidth + 24){ break; }
      }
      if(lane>=maxLanes){ lane = maxLanes-1; }
      lanes[lane] = x + labelWidth;

      // Edge-Clamping für die Label-Box (damit sie nicht abgeschnitten wird)
      let leftX = x;
      if (leftX + labelWidth > width - PADDING) leftX = width - PADDING - labelWidth;
      if (leftX < PADDING) leftX = PADDING;
      ev.style.left = Math.round(leftX) + 'px';

      // Vertikale Position der Box
      const baseY  = track.clientHeight/2;
      const laneGap = parseFloat(getComputedStyle(document.documentElement).getPropertyValue('--lane-gap')) || 90;
      const offset  = (lane+1)*laneGap;
      if(side==='top'){
        ev.style.top = (baseY - offset - 10) + 'px';
        ev.classList.add('top'); ev.style.setProperty('--lane', lane+1);
      }else{
        ev.style.top = (baseY + offset - 36) + 'px';
        ev.classList.add('bottom'); ev.style.setProperty('--lane', lane+1);
      }

      // --- FIX: Stiel & Punkt am TRACK platzieren (exakt auf der Mittellinie) ---
      const stem = document.createElement('div'); stem.className = 'stem';
      const dot  = document.createElement('div'); dot.className  = 'dot';

      const cx = Math.round(x);          // X-Position exakt am Datum
      stem.style.left = cx + 'px';
      dot.style.left  = (cx - 6) + 'px'; // Dot mittig über dem Stiel

      if (side === 'top') {
        stem.style.top    = (baseY - offset) + 'px';
        stem.style.height = offset + 'px';
        dot.style.top     = (baseY - 6) + 'px';
      } else {
        stem.style.top    = baseY + 'px';
        stem.style.height = offset + 'px';
        dot.style.top     = (baseY - 6) + 'px';
      }

      track.appendChild(stem);
      track.appendChild(dot);
      // --- Ende FIX ---
    });
  });

  // Offen/Zu
  const all = () => Array.from(document.querySelectorAll('details.event'));
  document.getElementById('openAll').addEventListener('click', ()=> all().forEach(d=> d.open=true));
  document.getElementById('closeAll').addEventListener('click', ()=> all().forEach(d=> d.open=false));
})();
</script>
</body>
</html>
